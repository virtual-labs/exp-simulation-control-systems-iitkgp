<!-- This HTML page and script files are developed by
    Piyali Chattopadhyay
    Project Scientist-Technical,
    Virtual Labs IIT Kharagpur.-->

<!DOCTYPE html>
<html lang="en"><!--html tag start-->
<head>
    <title>Simulation of Control Systems</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/adik.css" rel="stylesheet">
  
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script  src="./js/cs.js">   </script>
  
  
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>-->
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.js"></script>
  <script src=" https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.min.js  "></script>
 <script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>
 
<script src="https://cdn.plot.ly/plotly-2.25.2.min.js" charset="utf-8"></script>

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"> </script>

<link rel="stylesheet" href="./css/cs.css">

	


  <style>
	.bluedot{
	position:absolute;
    border: 2px solid blue;
    border-radius:50%;
    background-color:blue;
    background-image:linear-gradient(90deg,#0066ff,#00ccff);
	box-shadow: 5px 5px 8px #888888;
	}
	.handlep{
	position:absolute;
    border: 2px solid blue;
    border-radius:50%;
    background-color:white;
    background-image:url(./images/plus.png);
	background-size:cover;
	background-position:center;
	
	}
	
	.handlen{
	position:absolute;
    border: 2px solid blue;
    border-radius:50%;
    background-color:white;
    background-image:url(./images/minus.jpg);
	background-size:cover;
	background-position:center;
	
	}
	
	canvas {	
	max-width:100%;
	}

	@media print {
  body {
    visibility: hidden;
  }
  #plotbucket {
    visibility: visible;
    position: absolute;
    left: 0;
    top: 0;
  }
}
	
  </style>
  
  
  
</head>
<body><!--body tag start-->
    <div class="container p-3 my-3 text-primary text-center border"><!--First Container under body tag start-->
        <!--<div class="row"><!--First row under 1st container start--
            <div class="col-md-3"><!--First col under 1st row start--
                <img class="img-fluid rounded" src="./images/vlabs.png" alt="VLabs logo">
            </div><!--First col under 1st row end--
            <div class="col-md-6"><!--2nd col under 1st row start--
                <p class="display-1"> <b> Virtual Labs <br> IIT Kharagpur </b> </p>
            </div><!--2nd col under 1st row end--
            <div class="col-md-3"><!--3rd col under 1st row start--
                <img class="img-fluid rounded" src="./images/iitkgp.png" alt="IIT KGP Logo" >
            </div><!--3rd col under 1st row end--
        </div><!--First row under 1st container end-->
    
        <hr>
        <div class="row"><!--2nd row under 1st container start-->
            <div class="col-md-3"><!--First col under 2nd row start-->

            </div><!--First col under 2nd row end-->
            <div class="col-md-6"><!--2nd col under 2nd row start-->
                <p class="h1"> <b>Simulation</b> </p>
            </div><!--2nd col under 2nd row end-->
            <div class="col-md-3"><!--3rd col under 2nd row start-->

            </div><!--3rd col under 2nd row end-->
        </div><!--2nd row under 1st container end-->
        <hr>
        <!--<div class="d-flex p-1 text-primary"><!--3rd row under 1st container start--
          <div class="p-1" > <p class="h4"><a href="../index.html"> <span class="LN"> <b> Control and Instrumentation Lab </b></span> -- </a></p></div>
          <div class="p-1"> <p class="h4"><a href="./index.html"> <span class="ExpN"> <b> Simulation of Control Systems </b> </span> </a></p></div>
        </div><!--3rd row under 1st container end-->
    </div><!--First Container under body tag end-->
    
    <!--<div class="container p-3 my-5 text-primary text-center border"><!--2nd Container under body tag start--
        <div class="row"><!--First row under 2nd container start--

            <ul class="nav nav-pills nav-justified">
                <li class="nav-item">
                  <a class="nav-link" href="../index.html">Introduction</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../aim.html">Objective</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../prequiz.html">Pre Quiz</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../theory.html">Theory</a>
                </li>
				<li class="nav-item">
                  <a class="nav-link" href="../procedure.html">Procedure</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="./index.html">Simulation</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../postquiz.html">Post Quiz</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../feedback.html">Feedback</a>
                  </li>
                <li class="nav-item">
                    <a class="nav-link" href="../references.html">References</a>
                  </li>

              </ul>
        </div><!--First row under 2nd container end--
    </div><!--2nd Container under body tag end-->
	
    <div class="container p-3 my-5 text-left border"><!--3rd Container under body tag start-->
      <div class="row"><!--First row under 3rd container start-->
        <div class="col-md-1"></div><!--First col under 3rd container start& end-->
        <div class="col-md-10"><!--2nd col under 3rd container start-->
            <p class="text-center bg-success"> <a class="nav-link" data-bs-toggle="tab"  id="instcontrol" style="background-color:#128BD9"  ><span class=" h3 text-dark"> Instructions </span></a>
              <div id="inst" style="display:block;height:200px;overflow-y:auto;">
			  
			  <ol>
			  <b style="color:blue">Problem-1 ( Observe the response of a unity feedback system for different values of &zeta; )</b><br/>
                      <li>At first click on "Problem 1" button and select the input signal ( Unit Step or Unit Impluse ). In the given unity feedback system, set the value of &zeta; ( damping ratio ) throuh the up-down arrows
						in the input box in denominator of plant transfer function G ( s ).</li></br>
  
					  <li>&zeta; can be varied from 0 to 1. After the value of &zeta; is set click on the 'RUN' button to observe the system response for the particular input signal and &zeta value.</li><br/>
					 
					 <li>Click on 'Download Plot' button to download the response plot. Click on 'Ok' button.</li></br>
					 
					 <li>Click on '3D-Plot' button then on either '3D Step' or '3D Impulse' ( depending on the type of input signal, chosen in step 1 )
					 to observe the 3D response plot for that particular input signal, where x-axis represents time (sec), y-axis represents &zeta; ( damping ratio ) and z-axis 
					 represents the system response. Click on 'Ok' button.</li></br>

					 <li>Change the value of &zeta; and repeat step 2-4.</li><br/>			
						 
		   </ol>
		   <br/><br/>
		    <ol>
			  <b style="color:blue">Problem-2 ( Plot the root loci for the unity feedback system )</b><br/>
                      <li>At first click on "Problem 2" button and select the input signal ( Unit Step or Unit Impluse ). In the given unity feedback system, set the value of K ( gain ) throuh the up-down arrows
						in the input box in numarator of plant transfer function G ( s ).</li></br>
  
					  <li>'K' can be varied from 1 to 50. After the value of K is set click on the 'RUN' button, then on 'Root Locus' to observe the root locus plot of the system for that particular gain. The plot can be zoomed by selecting an area under the plot. Click on 'Ok' button to clear it.
					  Similarly, click on the 'RUN' button, then on 'Output Response' to observe the system response for the particular input signal and K value.</li><br/>
					 
					 <li>The plots can be downloaded by clicking on 'Download Plot' button. Click on 'Ok' button.</li></br>

					 <li>Change the value of gain K and repeat step 2-3.</li><br/>			
						 
		   </ol>
		   <br/><br/>
		    <ol>
			  <b style="color:blue">Problem-3 ( Bode and Nyquist plot for the unity feedback system )</b><br/>
                      <li>At first click on "Problem 3" button and enter the desired range for angular frequency &omega; in the
					  input box below the block diagram. The plant transfer function G ( s ) is given.</li></br>
  
					  <li>Click on the 'RUN' button, then on 'Bode Plot' to observe the Bode plot of the system. The plot can be zoomed by selecting an area under the plot. Click on 'Ok' button to clear it.
					  Similarly, click on the 'RUN' button, then on 'Nyquist Plot' to observe the Nyquist plot of the system.</li><br/>
					 
					 <li>The plots can be downloaded by clicking on 'Download Plot' button. Click on 'Ok' button.</li></br>

					 <li>Observe the gain margin, phase margin, gain cross over frequency and phase cross over frequency.</li><br/>
					 
					<li>Change the value of gain k and repeat step 2-4.</li><br/>	 
		   </ol>
		   <br/><br/>
		    <ol>
			  <b style="color:blue">Problem-4 ( System response of a Permanent Magnet DC Motor )</b><br/>
                      <li>At first click on "Problem 4" button and enter the desired value of supply voltage V. The dc motor circuit diagram is given.</li></br>
  
					  <li>Click on the 'RUN' button to observe the system response( speed(rad/s) vs. time ) as well as the motor armature current, speed, motor torque ( T<sub>M</sub> ), load torque ( T<sub>L</sub> ).</li><br/>
					 
					 <li>The plots can be downloaded by clicking on 'Download Plot' button. Click on 'Ok' button.</li></br>

					 <li>Change the value of supply voltage V and repeat step 2-3.</li><br/>			
						 
		   </ol>
		   </div>
            </p> 
          </div><!--2nd col under 3rd container end-->
		  
        <div class="col-md-1"></div><!--3rd col under 3rd container start& end-->
      </div><!--First row under 3rd container end-->
    </div><!--3rd Container under body tag end-->
	
    <div class="container p-3 my-5 text-center border" id="canvas" ><!--Fourth container under body tag start-->
	
	<div class="row my-5 gy-2">
	<div class="col-md-1"></div>
	<div class="col-md-10">
	
	
			<div   class="img-container">
			<div class="d-inline-flex p-2">
			<div class="dropdown">
			<button type="button" onclick="problem1()" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Problem 1</button>
						
					  <ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="tostep()">R ( s ) = Unit Step</a></li>
						<li><a class="dropdown-item" onclick="toimpulse()">R ( s ) = Unit Impulse</a></li>
					</ul>			
			</div>&nbsp;
			
			<div class="dropdown">
			<button type="button" onclick="problem2()" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Problem 2</button>
						
					  <ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="tostep()">R ( s ) = Unit Step</a></li>
						<li><a class="dropdown-item" onclick="toimpulse()">R ( s ) = Unit Impulse</a></li>
					</ul>			
			</div>&nbsp;
			
			<button type="button" onclick="problem3()"  class="btn btn-primary" >Problem 3</button>&nbsp;
			
			<!--<div class="dropdown">-->
			<button type="button" onclick="problem4()" class="btn btn-primary " >Problem 4</button>
						
					  <!--<ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="tostep()">R ( s ) = Unit Step</a></li>
						<li><a class="dropdown-item" onclick="toimpulse()">R ( s ) = Unit Impulse</a></li>
					</ul>			
			</div>-->&nbsp;
			</div>
			
			</div>
		
	
	
	
	</div>
	<div class="col-md-1"></div>
	</div>
	
		<div class="row my-5 gy-2"><!--- 1st row under fourth container start--->
		
			
        
			<div class="col-md-12" ><!--1st col under 1st row start -->
				  <!-- Code Start here--> 
				  <button type="button" id="run1" class="btn btn-success" onclick="problem1_simulation()" > RUN</button>
				  
				  <div class="dropdown" id="run2" style="display:none;">
				<button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">RUN</button>
						
					  <ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="rootloci()">Root Locus</a></li>
						<li><a class="dropdown-item" onclick="loci_plot()">Output Response</a></li>
					</ul>			
				</div>
				 <div class="dropdown" id="run3" style="display:none;">
				<button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">RUN</button>
						
					  <ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="Bode()">Bode Plot</a></li>
						<li><a class="dropdown-item" onclick="Nyquist()">Nyquist Plot</a></li>
					</ul>			
				</div>
				
				<div class="d-inline-flex p-2">
				 <div class="dropdown" id="run3d" style="display:block;">
				<button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">3D-Plot</button>
						
					  <ul class="dropdown-menu">
						<li><a class="dropdown-item" onclick="step_3D()">3D Step</a></li>
						<li><a class="dropdown-item" onclick="imp_3D()">3D Impulse</a></li>
					</ul>			
				</div>
				
				 <button type="button" id="run4" style="display:none;" class="btn btn-success" onclick="DC_Motor()" > RUN</button>
				
				</div>
				
				<div class="img-container"><!--img container div start-->
				
				
					<img class="img-fluid " id="controller" src="images/pr1.png " />
					
					
					<input type="number" id="z" min="0" max="1" step="0.1" value="0" title = "&zeta;">
					<input type="number" id="k" min="1" max="50" step="1" value="1" >
					<input type="number" id="k2" min="1" max="100" step="1" value="2" >
					<span id="vspan" style="display:none;">Supply voltage(volt)</span><input type="number" id="v" min="1" max="15" step="1" value="10" title = "Supply voltage">
					<span id="sspan" style="display:none;">Speed(rad/s)</span><input type="number" id="speed" value="0" title = "Speed in rad/s" readonly=readonly>
					<span id="aspan" style="display:none;">Armature Current(Amp)</span><input type="number" id="armamp" value="0" title = "Armature current in Amp" readonly=readonly>
					<span id="tmspan" style="display:none;">T<sub>M</sub>(N/m)</span><input type="number" id="torque" value="0" title = "Motor Torque" readonly=readonly>
					<span id="tlspan" style="display:none;">T<sub>L</sub>(N/m)</span><input type="number" id="load_torque" value="0" title = "Load Torque" readonly=readonly>
		  
				</div><!--img container div end--><br>
				
				<input type="number" id="seudo1" min="1" max="2" value="1" style="visibility:hidden" >
			</div><!---end of 1st col under 1st row--->	
			
        </div><!--1st row under fourth container end-->

 
  

	 <div class="row justify-content-center"><!-----------------------graph T vs. w----------------------------------------->
		
	 
			<div class="col-md-12">
			<input type="number" id="orange" min="10" max="200"  step="10" style="display:none;width: 14%;" placeholder="Enter range of &omega;">
				<button type="button" id="exportChart" class="btn btn-primary"  style="display:none;">Download Plot</button>&nbsp;&nbsp;
				<button type="button" id="result" class="btn btn-danger" onclick="Refresh()"  style="display:none;">OK</button><br/>
				<div id = "plotbucket" class="content-center" style="display:none; position: relative; border:3px solid white;height:530px;width:823px ">
				
					<div id="chartContainer"  style="display:none; position:absolute; height: 50%; width: 60%;z-index:1 "></div>
					<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
					<div id="chartContainer2"  style="display:none; position:absolute; height: 50%; width: 60%;z-index:1 "></div><br/>
					
					
					
				</div><br/>
								
				<span id="ovspan" style="display:none;color:blue">&percnt; Overshoot = <span id="oversut"></span></span>
				
				<span id="wpc_span" style="display:none;color:blue">Phase Cross over Frequency = <input type="number" id="wpc" readonly=readonly></span><br/>
				<span id="wgc_span" style="display:none;color:blue">Gain Cross over Frequency = <input type="number" id="wgc" readonly=readonly></span><br/>
				<span id="GM_span" style="display:none;color:blue">Gain Margin = <input type="number" id="GM" readonly=readonly></span><br/>
				<span id="PM_span" style="display:none;color:blue">Phase Margin = <input type="number" id="PM" readonly=readonly></span><br/>
				
			</div>
			
			
		
	</div>	
	
	<div class="row justify-content-center"><!-----------------------graph T vs. w----------------------------------------->
		
	 
			<div class="col-md-12">
			
			<div id="tester" style="display:none;width:800px;height:800px;"></div>
			<button type="button" id="3dok" class="btn btn-danger" onclick="ok3d()"  style="display:none;">OK</button><br/>
				

			</div>
	</div>
          <!-- Code End here-->
        </div><!--Fourth container under body tag end-->
          
      <!--</div>
    </div>-->

    <div class="container p-3 my-5 text-primary text-center border"><!--Last and fifth container under body tag start-->
      <div class="row">
        <footer>
          <div class="row ce">
            <div class="col-sm-12">
              <p class="h5"><i> Copyright ©2022 <a href="http://vlabs.iitkgp.ac.in/vlt/">Virtual Labs IIT Kharagpur</a> </i><br><br>
              <a href="../../license/index.html" target="_blank"> Licensing Terms </a>
            </p>
            </div>
          </div>
        </footer>
      </div>
  </div><!--Last and fifth container under body tag end-->
  
   
	
	
</body><!--body tag end-->
<script>

function step_3D(){///problem1,step response
document.getElementById('tester').style.display = "block";
document.getElementById('3dok').style.display = "block";

var yop = [];

var xValue = [];
var yValue = [];
var zValue =[];

var zeta = document.getElementById('z').value;
var wn = 5;

var omegad = math.multiply(wn, math.sqrt(math.subtract(1, math.pow(zeta,2))));
var phi = math.acos(zeta);

if(zeta == 0){///undamped
	
for(var t = 0; t<=10; t+=0.1){
	
yop[t] = math.subtract(1,math.cos(math.multiply(wn,t)));	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
	
}	

}
	
if(zeta == 1){
	
for(var t = 0; t<=10; t+=0.1){///citically damped
	
var epart = math.pow(math.e,-math.multiply(wn,t));	
yop[t] = math.subtract(1, math.add(epart, math.multiply(wn,t,epart)));	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
	
}	

}	
if(zeta > 0 && zeta < 1){///under damped

for(var t = 0; t<=10; t+=0.1){	
var wd = math.multiply(wn, math.sqrt(math.subtract(1, math.pow(zeta,2))));	
var theta = math.acos(zeta);	
var epart2 = math.pow(math.e,-math.multiply(zeta,wn,t)); 	
var rootz = math.sqrt(math.subtract(1, math.pow(zeta,2)));

yop[t] = math.subtract(1, math.multiply(math.divide(epart2,rootz), math.sin(math.add(math.multiply(wd,t),theta))));	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
}

}
var data = [
    {
        type: "scatter3d",
		mode: "lines",
        x: xValue,
        y: yValue,
        z: zValue,
       
        //colorscale: "Reds"
    }
];

var layout = {
	title: "3D Step plot",
    //margin: {t:100, l:100, b:100},
	scene: {
   xaxis: {
	title: 'x-axis(Time (sec))'
		
	},
	yaxis: {
	title: 'y-axis(\u03b6 (Damping ratio))'
		
	},
	zaxis: {
	title: 'z-axis(System response)'
		
	}
	}
    /*scene: {
        camera: {
            eye: {
                x: 1.88,
                y: -2.12,
                z: 0.96
            },
        },
    },*/
	
};
Plotly.newPlot('tester', data, layout, {showSendToCloud: true});

}

function imp_3D(){///problem1,imp response
document.getElementById('tester').style.display = "block";
document.getElementById('3dok').style.display = "block";
var yop = [];

var xValue = [];
var yValue = [];
var zValue =[];
	
var zeta = document.getElementById('z').value;
var wn = 5;

if(zeta == 0){///undamped
	
for(var t = 0; t<=10; t++){
	
yop[t] = math.multiply(wn,math.sin(math.multiply(wn,t)));	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
	
}	
	
}
	
if(zeta == 1){
	
for(var t = 0; t<=10; t++){///citically damped
	
var epart = math.pow(math.e,-math.multiply(wn,t));	
yop[t] = math.multiply(math.pow(wn,2),t,epart);	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
	
}	
	
}	
if(zeta > 0 && zeta < 1){///under damped

for(var t = 0; t<=10; t++){	
var wd = math.multiply(wn, math.sqrt(math.subtract(1, math.pow(zeta,2))));	
var theta = math.acos(zeta);	
var epart2 = math.pow(math.e,-math.multiply(zeta,wn,t)); 	
var rootz = math.sqrt(math.subtract(1, math.pow(zeta,2)));

yop[t] = math.multiply(math.divide(epart2,rootz), math.sin(math.multiply(wd,t)));	
xValue.push(t);
yValue.push(zeta);
zValue.push(yop[t]);
	
}

}
var data = [
    {
        type: "scatter3d",
		mode: "lines",
        x: xValue,
        y: yValue,
        z: zValue,
       
        //line: {color:"red"}
    }
];

var layout = {
	title: "3D Impulse plot",
    //margin: {t:100, l:100, b:100},
	scene: {
   xaxis: {
	title: 'x-axis(Time (sec))'
		
	},
	yaxis: {
	title: 'y-axis(\u03b6 (Damping ratio))'
		
	},
	zaxis: {
	title: 'z-axis(System response)'
		
	}
	}
    /*scene: {
        camera: {
            eye: {
                x: 1.88,
                y: -2.12,
                z: 0.96
            },
        },
    },*/
	
};

Plotly.newPlot('tester', data, layout, {showSendToCloud: true});
}




















</script>


















</html><!--html tag end-->